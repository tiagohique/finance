

Aqui est√° um prompt completo para voc√™ reutilizar em outra LLM. Copie e cole como est√°:

Voc√™ agora assume o papel do meu assistente t√©cnico. Preciso que continue exactamente o trabalho que j√° est√° em andamento neste projeto. Abaixo segue todo o contexto, decis√µes, comandos executados, ajustes feitos e o estado atual do backend NestJS e do frontend React/Vite. Utilize essas informa√ß√µes para responder a futuras d√∫vidas ou para continuar a implementa√ß√£o sem se perder na hist√≥ria.

--------------------------------------------------------------------------------
üß≠ CONTEXTO GERAL
- Projeto: aplicativo de finan√ßas pessoais (NestJS + React/Vite + Tailwind, Zustand, Axios).
- Estrutura b√°sica:
  /app/backend  ‚Üí API NestJS com persist√™ncia em JSON + Swagger
  /app/frontend ‚Üí SPA React com Vite, Tailwind, Zustand (para filtros/toasts), vitest/TL para testes
  README.md     ‚Üí instru√ß√µes de setup, scripts, vari√°veis

--------------------------------------------------------------------------------
üì¶ BACKEND (NestJS)
- package.json scripts relevantes:
  start:dev          - ts-node-dev
  build              - tsc -p tsconfig.build.json
  start:prod         - node dist/main.js (usa build pr√©vio)
  lint               - eslint "src/**/*.{ts,tsx}"
  test               - jest

- Depend√™ncias principais: @nestjs/*, class-validator/transformer, @nestjs/swagger, swagger-ui-express, express-basic-auth, rxjs, nanoid.
- Dev deps: jest + ts-jest, eslint/prettier, typescript 5.4.5, ts-node-dev, etc.

- Arquitetura:
  - M√≥dulos: salaries, incomes, expenses, categories, reports, health.
  - Persist√™ncia via JsonFileRepository (que garante escrita at√¥mica + locking leve).
  - DTOs com class-validator; controllers com valida√ß√£o + Swagger.
  - Data seeds iniciais em /app/backend/data/*.json (sal√°rios, receitas, despesas, categorias).

- Ajustes importantes feitos:
  1. JsonFileRepository corrigido para o build TypeScript (fila AsyncLock com Promise<void>).
  2. CORS: agora aceita origens `http://localhost:5173`, `http://127.0.0.1:5173`, `http://localhost:3010`, `http://127.0.0.1:3010` e extras via env `CORS_ORIGINS`.
  3. Swagger protegido com basic auth (`SWAGGER_USER`, `SWAGGER_PASSWORD`, default admin/admin123).
  4. README atualizado com instru√ß√µes de Docker e credenciais.

- Dockerfile multi-stage (Node 20 alpine): faz npm ci, build, e copia dist + data; exp√µe porta 3000.

- Teste automatizado dispon√≠vel: test/reports.service.spec.ts.

--------------------------------------------------------------------------------
üñ•Ô∏è FRONTEND (React + Vite + Tailwind)
- package.json inclui scripts: dev, build, lint, preview, test (vitest run).
- deps: react 19, react-router-dom 7, axios, zustand, clsx; dev deps: vite 7, vitest, Testing Library, Tailwind.
- Tailwind configurado com tema custom e dark mode class.

- Pastas principais:
  - src/components (layout, common, tests de MonthPicker).
  - src/pages (Dashboard, Incomes, Expenses, Categories, Reports).
  - src/store (useFiltersStore com persist√™ncia em localStorage + expira√ß√£o de 12 meses; useToastStore).
  - src/services (api axios com handleApiError, financeService centralizando chamadas).
  - src/utils (format, period).
  - vitest.config.ts (novo arquivo s√≥ para testes; vite.config.ts ficou limpo para build).

- Ajustes importantes feitos no frontend:
  1. Estado global (filtros/toasts) com Zustand; filtros agora resetam para m√™s/ano atual se o dado salvo tiver dist√¢ncia > 12 meses.
  2. MonthPicker com labels abreviadas (JAN, FEV, ‚Ä¶) e select adaptado para mobile/desktop.
  3. Dashboard:
     - Cards com `overflow-hidden` e valores coloridos.
     - Sal√°rio: formul√°rio inline, bot√£o para atualizar.
     - Lista de transa√ß√µes com DataTable adaptada para mobile (`table-fixed`, wrap, etc.).
     - ‚ÄúGastos por categoria‚Äù: barras limitadas a 100%, trocam para vermelho quando estouram o or√ßamento, texto com quebra de linha e percentual abaixo (ainda precisa verificar se a largura 100% resolveu todo overflow).
  4. Inputs form (FormInput/MoneyInput) tratam modo escuro com `dark:bg-slate-900 dark:text-slate-100`.
  5. Navbar: bot√£o ‚Äú‚â°‚Äù, bot√£o Dashboard (Link para home), ThemeToggle com Zustand + localStorage.
  6. Tabelas & layout: DataTable com `w-full` e `max-w-full`, AppLayout com container responsivo multi-breakpoint.
  7. MonthPicker tamb√©m permite wrap nos controles; body tem `overflow-x-hidden`.
  8. Teste React: `MonthPicker.test.tsx` (Vitest + Testing Library). Config de compila√ß√£o exclui arquivos de teste via tsconfig.app.json.

- Dockerfile para frontend:
  - Stage Node 20 alpine (npm ci, build com VITE_API_BASE_URL).
  - Stage nginx 1.27 alpine copiando dist para /usr/share/nginx/html.
  - Lembrar de build arg `VITE_API_BASE_URL=http://host.docker.internal:3000/api`.

- `.env` (ou `.env.local`) deve ter `VITE_API_BASE_URL=http://localhost:3000/api` quando rodando sem Docker.

--------------------------------------------------------------------------------
‚öôÔ∏è EXECU√á√ÉO LOCAL (sem Docker)
- Backend:
  ```bash
  cd app/backend
  npm install
  npm run start:dev
  # Porta 3000
Swagger: http://localhost:3000/api/docs (admin/admin123).

Frontend:

cd app/frontend
npm install
npm run dev
# Porta 5173
Antes: garantir .env com VITE_API_BASE_URL=http://localhost:3000/api.

Para acessar via celular na mesma rede:

Descobrir IP do Mac (ipconfig getifaddr en0).
Backend: CORS_ORIGINS=http://<IP>:5173 npm run start:dev.
Frontend: .env com VITE_API_BASE_URL=http://<IP>:3000/api, rodar npm run dev -- --host 0.0.0.0.
Abrir no celular: http://<IP>:5173.
Parar processos: Ctrl+C. Tests: backend npm run test; frontend npm run test.

üê≥ EXECU√á√ÉO COM DOCKER

Backend:
cd app/backend
docker build -t financas-backend .
docker run --name financas-backend -p 3000:3000 \
  -e SWAGGER_USER=admin \
  -e SWAGGER_PASSWORD=admin123 \
  financas-backend
Frontend:
cd app/frontend
docker build -t financas-frontend \
  --build-arg VITE_API_BASE_URL=http://host.docker.internal:3000/api .
docker run --name financas-frontend -p 3010:80 financas-frontend
Ajustar portas mudando o primeiro valor de -p externa:interna (ex.: backend -p 8080:3000, frontend -p 8081:80).
Checar fatores de contexto do Docker (imagens rodando, containers, etc.).
üõ†Ô∏è CORRE√á√ïES & BUGS RESOLVIDOS

Backend: problema de build TS (AsyncLock) ajustado.
Swagger protegido com basic auth.
CORS liberado para 5173/3010 e vari√°veis extras.
Frontend: layout mobile (tabelas/cards/MonthPicker) adaptado; barra de categoria; inputs com texto branco no dark mode.
Filtro de datas: reseta se valor salvo antigo demais.
Docker builds funcionais tanto backend quanto frontend.
Acesso via host.docker.internal para comunicar cont√™iner frontend ‚Üí backend.
üöß PONTOS A MONITORAR

Layout ‚ÄúGastos por categoria‚Äù ainda pode sofrer se o viewport for muito estreito; verificar se o overflow foi totalmente resolvido agora.
Sempre rebuildar e subir containers ap√≥s mudan√ßas (desligar com docker stop; docker rm se precisar recriar).
Garantir que npm run dev do Vite rode com --host 0.0.0.0 ao testar em dispositivos externos.
Atualizar CORS_ORIGINS quando usar IPs ou dom√≠nios diferentes do que j√° est√° listado.
üìÅ ARQUIVOS CHAVE (refer√™ncias r√°pidas)

Backend: src/main.ts, src/common/file-db/json-file.repository.ts, src/reports/reports.service.ts, package.json, Dockerfile.
Frontend: src/pages/DashboardPage.tsx, src/components/common/Card.tsx, src/components/common/DataTable.tsx, src/components/common/FormInput.tsx, src/components/layout/AppLayout.tsx, src/store/useFiltersStore.ts, src/services/financeService.ts, vite.config.ts, vitest.config.ts, Dockerfile.
Testes: test/reports.service.spec.ts (backend), src/components/common/__tests__/MonthPicker.test.tsx (frontend).
Docs: README.md (setup completo + docker instructions).
üìù OBJETIVO PARA A NOVA LLM

Continuar evoluindo o projeto (melhorias, corre√ß√µes, implementa√ß√µes novas) com base nesse hist√≥rico.
Responder perguntas de manuten√ß√£o/uso (ex.: rodar local, rodar testes, subir containers, liberar para rede externa, etc.).
Garantir consist√™ncia com configura√ß√µes atuais (dark mode, layout mobile, CORS, Docker builds).
Se precisar de comandos, logs ou quaisquer detalhes espec√≠ficos, pergunte. Tudo o que foi feito at√© agora est√° descrito acima.